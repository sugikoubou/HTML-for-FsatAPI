<!doctype html>
<html lang=en>
  <head>
    <meta charset=utf-8>
    <title>看板画像分類システム</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
          rel="stylesheet" 
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
          crossorigin="anonymous">
    
    
    <link rel="stylesheet" type="text/css" href="/main.css">
    
    <!--
 ここで後でアイコン変えよう
    -->
    <link rel="icon" href="/favicon.ico" />
	
	<style>
  	canvas, video{
    	border: 1px solid gray;
 	}
  	</style>
    
  </head>
  <body>
   <div class="shiro">
    	<h2>店舗推測を送信された画像から行います</h2>


    	<form method="post" action="" enctype="multipart/form-data" class="mycss">
	<input type="file" id="file" name="file" accept="image/*" />
	<input type="button" class="button" value="Upload" id="but_upload">
			
	</form>
	    
		<div id="app">
    			<label for="upload">写真を撮影してアップロードする</label>
    			<input id="upload" type="file" name="image" accept="image/*" capture>
		</div>
		
		
		
　　</div>
	  
    	<video id="camera" width="600" height="400"></video>
	<canvas id="picture" width="600" height="400"></canvas>
    <form>
 	<button type="button" id="shutter">シャッター</button>
    </form>
	  
	  
<script>
window.onload = () => {
  const video  = document.querySelector("#camera");
  const canvas = document.querySelector("#picture");

  /** カメラ設定 */
  const constraints = {
    audio: false,
    video: {
      width: 300,
      height: 200,
      facingMode: "user"   // フロントカメラを利用する
      // facingMode: { exact: "environment" }  // リアカメラを利用する場合
    }
  };
<script>
window.onload = () => {
  const video  = document.querySelector("#camera");
  const canvas = document.querySelector("#picture");

  /** カメラ設定 */
  const constraints = {
    audio: false,
    video: {
      width: 300,
      height: 200,
      facingMode: "user"   // フロントカメラを利用する
      // facingMode: { exact: "environment" }  // リアカメラを利用する場合
    }
  };

  /**
   * カメラを<video>と同期
   */
  navigator.mediaDevices.getUserMedia(constraints)
  .then( (stream) => {
    video.srcObject = stream;
    video.onloadedmetadata = (e) => {
      video.play();
    };
  })
  .catch( (err) => {
    console.log(err.name + ": " + err.message);
  });

  /**
   * シャッターボタン
   */
   document.querySelector("#shutter").addEventListener("click", () => {
    const ctx = canvas.getContext("2d");

    // 演出的な目的で一度映像を止めてSEを再生する
    video.pause();  // 映像を停止
   
    setTimeout( () => {
      video.play();    // 0.5秒後にカメラ再開
    }, 500);

    // canvasに画像を貼り付ける
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  });
};
</script>
	
	
	


    <div id="hello-wrapper">
      
      <div id="particles-js"></div>
      
      <div class="content position-relative w-100 top-2 pt-3">
        <div class="cta">
          <div id="hello" class="typewriter pb-3">
            サイトの配置
          </div>
          
          <a class="btn btn-primary mb-5" href="https://38b2-2400-4150-4341-1f00-3dad-545c-8e7c-8010.ngrok.io/">
          WebAPIココ
          </a>
        </div>
        <div id="world">
          
          <canvas id='rotatingGlobe' style='cursor: move;'></canvas>
        </div>
      </div>
    </div>
    <script type='text/javascript' src='//d3js.org/d3.v3.min.js'></script>
    <script type='text/javascript' src='//d3js.org/topojson.v1.min.js'></script>
    <script type='text/javascript' src='planetaryjs.min.js'></script>
    <script src="//cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script type='text/javascript' src='particles.js'></script>
    <script type='text/javascript' src='globe.js'></script>
  </body>
</html>
